{"version":3,"sources":["turbopack:///[project]/node_modules/next/src/server/route-modules/app-page/module.compiled.js","turbopack:///[project]/node_modules/next/src/server/route-modules/app-page/vendored/ssr/react-jsx-runtime.ts","turbopack:///[project]/node_modules/next/src/server/route-modules/app-page/vendored/ssr/react.ts","turbopack:///[project]/Projects/Jules/align_audio/frontend/app/page.tsx"],"sourcesContent":["if (process.env.NEXT_RUNTIME === 'edge') {\n  module.exports = require('next/dist/server/route-modules/app-page/module.js')\n} else {\n  if (process.env.__NEXT_EXPERIMENTAL_REACT) {\n    if (process.env.NODE_ENV === 'development') {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo-experimental.runtime.dev.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page-experimental.runtime.dev.js')\n      }\n    } else {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo-experimental.runtime.prod.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page-experimental.runtime.prod.js')\n      }\n    }\n  } else {\n    if (process.env.NODE_ENV === 'development') {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo.runtime.dev.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page.runtime.dev.js')\n      }\n    } else {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo.runtime.prod.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page.runtime.prod.js')\n      }\n    }\n  }\n}\n","module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-ssr']!.ReactJsxRuntime\n","module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-ssr']!.React\n","\"use client\";\n\nimport { ChangeEvent, FormEvent, useState } from \"react\";\nimport axios from \"axios\";\n\ninterface JobResponse {\n  job_id: string;\n  status: string;\n}\n\ninterface ResultResponse {\n  job_id: string;\n  status: string;\n  offset_sec?: number;\n  ffmpeg_command?: string;\n  inhouse_url?: string;\n  external_url?: string;\n  aligned_audio_url?: string;\n  waveform_png_url?: string;\n  similarity_png_url?: string;\n}\n\nexport default function HomePage() {\n  const [inhouseFile, setInhouseFile] = useState<File | null>(null);\n  const [externalFile, setExternalFile] = useState<File | null>(null);\n  const [mode, setMode] = useState(\"external_to_inhouse\");\n  const [anchorMode, setAnchorMode] = useState(\"xcorr\");\n  const [status, setStatus] = useState<string | null>(null);\n  const [result, setResult] = useState<ResultResponse | null>(null);\n  const [loading, setLoading] = useState(false);\n\n  const apiBase = process.env.NEXT_PUBLIC_API_BASE_URL ?? \"http://localhost:8000\";\n\n  const handleSubmit = async (e: FormEvent<HTMLFormElement>) => {\n    e.preventDefault();\n    if (!inhouseFile || !externalFile) return;\n    setLoading(true);\n    setStatus(\"Uploading and creating job...\");\n    setResult(null);\n\n    const formData = new FormData();\n    formData.append(\"inhouse_file\", inhouseFile);\n    formData.append(\"external_file\", externalFile);\n    formData.append(\"mode\", mode);\n    formData.append(\"anchor_mode\", anchorMode);\n\n    try {\n      const { data } = await axios.post<JobResponse>(\n        `${apiBase}/api/v1/alignments`,\n        formData,\n        {\n          headers: { \"Content-Type\": \"multipart/form-data\" },\n        }\n      );\n\n      setStatus(`Job queued: ${data.job_id}`);\n\n      // Poll for result\n      const poll = async () => {\n        const res = await axios.get<ResultResponse>(\n          `${apiBase}/api/v1/alignments/${data.job_id}`\n        );\n        setStatus(`Job status: ${res.data.status}`);\n        if (res.data.status === \"completed\" || res.data.status === \"failed\") {\n          setResult(res.data);\n          setLoading(false);\n        } else {\n          setTimeout(poll, 1500);\n        }\n      };\n\n      poll();\n    } catch (err) {\n      console.error(err);\n      setStatus(\"Error creating job\");\n      setLoading(false);\n    }\n  };\n\n  return (\n    <main className=\"min-h-screen bg-slate-950 text-slate-50 flex flex-col items-center py-10 px-4\">\n      <div className=\"w-full max-w-3xl\">\n        <header className=\"mb-8\">\n          <h1 className=\"text-3xl font-semibold mb-2\">Align Audio Studio</h1>\n          <p className=\"text-slate-300\">\n            Upload in-house and external audio, then compute alignment using xcorr\n            or content-based anchors.\n          </p>\n        </header>\n\n        <section className=\"bg-slate-900/70 border border-slate-800 rounded-xl p-6 mb-6 shadow-lg\">\n          <form onSubmit={handleSubmit} className=\"space-y-4\">\n            <div>\n              <label className=\"block text-sm font-medium mb-1\">In-house audio</label>\n              <input\n                type=\"file\"\n                accept=\"audio/*\"\n                onChange={(e: ChangeEvent<HTMLInputElement>) =>\n                  setInhouseFile(e.target.files?.[0] ?? null)\n                }\n                className=\"block w-full text-sm text-slate-200 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-indigo-500 file:text-white hover:file:bg-indigo-600\"\n              />\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-medium mb-1\">External audio</label>\n              <input\n                type=\"file\"\n                accept=\"audio/*\"\n                onChange={(e: ChangeEvent<HTMLInputElement>) =>\n                  setExternalFile(e.target.files?.[0] ?? null)\n                }\n                className=\"block w-full text-sm text-slate-200 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-indigo-500 file:text-white hover:file:bg-indigo-600\"\n              />\n            </div>\n\n            <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4\">\n              <div>\n                <label className=\"block text-sm font-medium mb-1\">Anchor mode</label>\n                <select\n                  value={anchorMode}\n                  onChange={(e) => setAnchorMode(e.target.value)}\n                  className=\"w-full rounded-md bg-slate-950 border border-slate-700 px-3 py-2 text-sm\"\n                >\n                  <option value=\"xcorr\">xcorr (fast)</option>\n                  <option value=\"content\">content (MFCC)</option>\n                </select>\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium mb-1\">Shift target</label>\n                <select\n                  value={mode}\n                  onChange={(e) => setMode(e.target.value)}\n                  className=\"w-full rounded-md bg-slate-950 border border-slate-700 px-3 py-2 text-sm\"\n                >\n                  <option value=\"external_to_inhouse\">External → In-house</option>\n                  <option value=\"inhouse_to_external\">In-house → External</option>\n                </select>\n              </div>\n            </div>\n\n            <button\n              type=\"submit\"\n              disabled={loading || !inhouseFile || !externalFile}\n              className=\"mt-2 inline-flex items-center justify-center rounded-md bg-indigo-500 px-4 py-2 text-sm font-medium text-white shadow hover:bg-indigo-600 disabled:opacity-40 disabled:cursor-not-allowed\"\n            >\n              {loading ? \"Aligning...\" : \"Align audio\"}\n            </button>\n          </form>\n\n          {status && (\n            <p className=\"mt-4 text-sm text-slate-300\">{status}</p>\n          )}\n        </section>\n\n        {result && result.status === \"completed\" && (\n          <section className=\"bg-slate-900/70 border border-slate-800 rounded-xl p-6 shadow-lg space-y-4\">\n            <h2 className=\"text-xl font-semibold mb-2\">Results</h2>\n            {result.offset_sec !== undefined && (\n              <p className=\"text-sm\">\n                Offset: <span className=\"font-mono\">{result.offset_sec.toFixed(6)} s</span>\n              </p>\n            )}\n            {result.ffmpeg_command && (\n              <div>\n                <p className=\"text-sm font-medium mb-1\">Suggested FFmpeg command:</p>\n                <pre className=\"bg-black/60 rounded-md p-3 text-xs overflow-x-auto\">\n                  {result.ffmpeg_command}\n                </pre>\n              </div>\n            )}\n\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n              {result.waveform_png_url && (\n                <div>\n                  <p className=\"text-sm font-medium mb-1\">Waveform overlay</p>\n                  <img\n                    src={`${apiBase}${result.waveform_png_url}`}\n                    alt=\"Waveform overlay\"\n                    className=\"w-full rounded-md border border-slate-800\"\n                  />\n                </div>\n              )}\n\n              {result.similarity_png_url && (\n                <div>\n                  <p className=\"text-sm font-medium mb-1\">Similarity curve</p>\n                  <img\n                    src={`${apiBase}${result.similarity_png_url}`}\n                    alt=\"Similarity curve\"\n                    className=\"w-full rounded-md border border-slate-800\"\n                  />\n                </div>\n              )}\n            </div>\n\n            <div className=\"space-y-2\">\n              {result.inhouse_url && (\n                <audio\n                  controls\n                  src={`${apiBase}${result.inhouse_url}`}\n                  className=\"w-full\"\n                />\n              )}\n              {result.external_url && (\n                <audio\n                  controls\n                  src={`${apiBase}${result.external_url}`}\n                  className=\"w-full\"\n                />\n              )}\n              {result.aligned_audio_url && (\n                <audio\n                  controls\n                  src={`${apiBase}${result.aligned_audio_url}`}\n                  className=\"w-full\"\n                />\n              )}\n            </div>\n          </section>\n        )}\n      </div>\n    </main>\n  );\n}\n"],"names":["process","env","NEXT_RUNTIME","module","exports","require","__NEXT_EXPERIMENTAL_REACT","NODE_ENV","TURBOPACK","vendored","ReactJsxRuntime","React"],"mappings":"yNA0BQG,GAAOC,OAAO,CAAGC,EAAQ,CAAA,CAAA,IAAA,iCC1BjCF,EAAOC,OAAO,CACZC,EAAQ,CAAA,CAAA,IAAA,GACRI,QAAQ,CAAC,YAAY,CAAEC,eAAe,+BCFxCP,EAAOC,OAAO,CACZC,EAAQ,CAAA,CAAA,IAAA,GACRI,QAAQ,CAAC,YAAY,CAAEE,KAAK,oCCA9B,EAAA,CAAA,CAAA","ignoreList":[0,1,2]}